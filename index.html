<!DOCTYPE html>
<html lang="zh-cmn-Hans" prefix="og: http://ogp.me/ns#" class="han-init">
<head>
  <meta charset="utf-8">
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>Submerged</title>
  <link rel="stylesheet" href="/submerged/css/style.css">
  <!--在这里倒入jquery 方便处理部分页面的jquery-->
  <script src="https://code.jquery.com/jquery-1.12.4.min.js" type="text/javascript"></script>
</head>

<body>
	
  <header class="site-header site-color" id="site-header-id">

  <div class="container">
      <h1><a href="/submerged/" title="Submerged"><span class="octicon octicon-mark-github"></span> Submerged</a></h1>
      <nav class="site-header-nav" role="navigation">
        
              
              <a href="/submerged/"  class=" site-header-nav-item hvr-underline-from-center" title="Home">Home</a>
        
              
              <a href="/submerged/hardware"  class=" site-header-nav-item hvr-underline-from-center" title="Hardware">Hardware</a>
        
              
              <a href="/submerged/mobile"  class=" site-header-nav-item hvr-underline-from-center" title="Mobile">Mobile</a>
        
              
              <a href="/submerged/getting-started"  class=" site-header-nav-item hvr-underline-from-center" title="Geting started">Geting started</a>
        
              
              <a href="http://blog.repsaj.nl/index.php/series/azure-aquarium-monitor/" target="target" class=" site-header-nav-item hvr-underline-from-center" title="Blog">Blog</a>
        
      </nav>
  </div>
</header>

	
    <section class="collection-head collection-head-scrolled geopattern" data-pattern-id="Submerged" >

    <div class="container">
        <div class="collection-title">
            <h1 class="collection-header">Submerged</h1>
            <div class="collection-info">
                <span class="meta-info">
                    
                        <span class="octicon octicon-calendar"></span>
                        <time datetime="2016-06-17T13:42:36.000Z" itemprop="datePublished">2016-06-17</time>
                    
                </span>
            </div>
        </div>
    </div>
</section>
	

    <section class="container content">

    <div class="columns">
        <div class="column three-fourths" >
            <article class="article-content article-entry">
                <p>Submerged is an opensource .NET based framework for connecting your aquarium to the IoT. The full solution consists of:</p>
<ul>
<li>An Azure based IoT back-end which collects data and hosts an API</li>
<li>Arduino devices connected to a Raspberry Pi running Windows IoT Core via Bluetooth</li>
<li>An Apache Cordova mobile app for mobile phones</li>
</ul>
<h1 id="What-does-it-do"><a href="#What-does-it-do" class="headerlink" title="What does it do?"></a>What does it do?</h1><p>Submerged is meant to help you monitor your aquarium in every way you want to. At the moment, I use it to monitor things like temperature, pH and leakage. Based on those readings you can set triggers so your phone notifies you as soon as things go south for whatever reason. It’s also possible to control hardware such as relays to switch power sockets on / off. And I’m planning on adding a lot more functionality such as an intelligent log which alerts you when your stock solutions or CO2 bottle need replacing.</p>
<h1 id="Supported-functionality"><a href="#Supported-functionality" class="headerlink" title="Supported functionality"></a>Supported functionality</h1><p>The current list of functionality includes:</p>
<ul>
<li><strong>Monitoring Sensors</strong>: <ul>
<li>Temperature (DS18B20)</li>
<li>pH (Atlas EZO pH)</li>
<li>Flow (hall effect flow sensors) </li>
<li>Leakage (generic moisture sensors)</li>
<li>Stock solution level (level switch sensors) </li>
</ul>
</li>
<li><strong>Getting Notifications</strong>: all of the sensors which output data can be monitored against min/max thresholds. A notification is sent to your mobile device as soon as one of the sensor reports an out of bound value. </li>
<li><strong>Controlling Relays</strong>: using your mobile app, you can control relays inside of your cabinet remotely. Maintenance mode allows to easily switch multiple relays on/off when performing tank maintenance. </li>
<li><strong>Live data</strong>: the measured data can be monitored live using the mobile app for smartphone. Internet connection required. </li>
<li><strong>Analytics</strong>: all data is aggregated and stored. This allows you to view long-term statics of your tank per hour, day, week or month. </li>
</ul>
<h1 id="How-do-I-use-it"><a href="#How-do-I-use-it" class="headerlink" title="How do I use it?"></a>How do I use it?</h1><p>At the moment, the sources are here for you to use under the Apache 2.0 License. To run the entire solution, you’ll need both the hardware (<a href="hardware.md">here</a>) as well as an Azure subscription to run the back-end. If you don’t want to run the Azure back-end yourself, please get in touch so I can add you yo my subscription. The end goal is to create a multi-tenant back-end so that you only need to plug in the hardware that you use.</p>
<p>More information on how I built this and how you configure the back-end parts can be found in this blog series: <a href="http://blog.repsaj.nl/index.php/series/azure-aquarium-monitor/" target="_blank" rel="external">http://blog.repsaj.nl/index.php/series/azure-aquarium-monitor/</a>.</p>
<h1 id="Solution-Overview"><a href="#Solution-Overview" class="headerlink" title="Solution Overview"></a>Solution Overview</h1><p>The solution architecture of submerged looks like this:</p>
<p><img src="http://www.repsaj.nl/Uploads/submerged/submerged_overview.png" alt="Solution Overview"></p>
<p>Here’s roughly what each component does:</p>
<ul>
<li>Each arduino device is called a <strong>module</strong> in order to standardize a bit. The “Sensor module” is capable of reading sensors (temperature, pH, flow, etc.). The “cabinet module” will control relays and connect to water sensors for leak detection. More module types might follow in the future.</li>
<li>A Raspberry Pi running Windows 10 IoT serves as a <strong>gateway</strong>. It connects to the different modules you have and communicates with Azure in a secure way. At the moment the modules are connected via Bluetooth, but I’m planning on maybe replacing that with Alljoyn.</li>
<li><strong>Azure IoT hub</strong> takes care of communications from and to the gateway. Your gateway needs to be registered as a device with IoT hub.</li>
<li>The incoming telemetry data is then processed by <strong>Azure Stream Analytics</strong>. One task ASA has is to seperate notifications and device data from normal telemetry data.</li>
<li>All data is stored in <strong>Azure blob storage</strong> where it can reside for a long time.</li>
<li>Notifications and device data are sent to a <strong>Event Hub</strong>. The items in the event hub are then processed by <strong>Azure functions</strong>.</li>
<li>Events are forwarded to a <strong>Notification hub</strong>. This hub takes care of forwarding the information to a registered device (such as your smartphone).</li>
<li>A <strong>WebAPI</strong> running in Azure serves as API. The API is secured using Azure AD.</li>
<li><strong>Azure DocumentDB</strong> is used to store information about the subscriptions, tanks, sensors and all stuff we need to run the service.</li>
<li>Lastly, a Cordova mobile app allows you to read out telemetry data, control relays and do all kinds of other stuff.</li>
</ul>
<h1 id="Can-I-contribute"><a href="#Can-I-contribute" class="headerlink" title="Can I contribute?"></a>Can I contribute?</h1><p>Yes, please! I’m very much looking for enthusiasts who’d like to help build this out more. There’s plenty of stuff to do. Here’s a todo list:</p>
<ul>
<li>Implement additional sensors / modules</li>
<li>Implement some of the missing features, such as the intelligent journal</li>
<li>Test the mobile app for iPhone, currently only Android is being used / tested</li>
<li>Build a web based entry point for management / extensive resporting / etc</li>
<li>Implement additional unit tests</li>
<li>Any other awesome additions I didn’t think of</li>
<li>There could probably be a little additional documentation, do check out the <a href="http://blog.repsaj.nl/index.php/series/azure-aquarium-monitor/" target="_blank" rel="external">blog series</a> for that too</li>
</ul>
<p>So please get in touch if you want to contribute in any way! :)</p>
<h1 id="What-do-I-get"><a href="#What-do-I-get" class="headerlink" title="What do I get?"></a>What do I get?</h1><p>Pictures say more than a thousands words!</p>
<p>Screendumps of the mobile app:</p>
<p><img src="http://www.repsaj.nl/Uploads/submerged/submerged_live.png" alt="Screenshot Live" width="400"><img src="http://www.repsaj.nl/Uploads/submerged/submerged_relays.png" alt="Screenshot Relays" width="400"></p>
<p>Screendump of the gateway dashboard:</p>
<p><img src="http://www.repsaj.nl/Uploads/submerged/submerged_dashboard.png" alt="Screenshot Dashboard" width="800"></p>

            </article>
            


            
                <div class="comment">
                    
<div class="comments">
    <div id="disqus_thread"></div>
    <script>
    /**
    * RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    * LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables
    */
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL; // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function() { // DON'T EDIT BELOW THIS LINE
    var d = document, s = d.createElement('script');

    s.src = '//submerged.disqus.com/embed.js';

    s.setAttribute('data-timestamp', +new Date());
    (d.head || d.body).appendChild(s);
    })();
    </script>
    <noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript" rel="nofollow">comments powered by Disqus.</a></noscript>
</div>
                </div>
            
        </div>
        <div class="column one-fourth">
            
                <h3>Post Directory</h3>

<div id="post-directory-module">
	<section class="post-directory">
		<p><strong class="toc-title">Index</strong></p>
		<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#What-does-it-do"><span class="toc-text">What does it do?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Supported-functionality"><span class="toc-text">Supported functionality</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#How-do-I-use-it"><span class="toc-text">How do I use it?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Solution-Overview"><span class="toc-text">Solution Overview</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Can-I-contribute"><span class="toc-text">Can I contribute?</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#What-do-I-get"><span class="toc-text">What do I get?</span></a></li></ol>
	</section>
</div>
            
        </div>
       
    </div>
</section>

<footer class="container">
    <div class="site-footer" role="contentinfo">
        <div class="copyright left mobile-block">
                © 2016
                <span title="yumemor">yumemor</span>
                <a href="javascript:window.scrollTo(0,0)" class="right mobile-visible">TOP</a>
        </div>

        <ul class="site-footer-links right mobile-hidden">
            <li>
                <a href="javascript:window.scrollTo(0,0)" >TOP</a>
            </li>
        </ul>

        <a href="https://github.com/yumemor/yumemor.github.io" target="_blank" aria-label="view source code">
            <span class="mega-octicon octicon-mark-github" title="GitHub"></span>
        </a>

        <ul class="site-footer-links mobile-hidden">
            
             
              
              <li>
                <a href="/submerged/"  title="Home">Home</a>
              </li>
            
              
              <li>
                <a href="/submerged/hardware"  title="Hardware">Hardware</a>
              </li>
            
              
              <li>
                <a href="/submerged/mobile"  title="Mobile">Mobile</a>
              </li>
            
              
              <li>
                <a href="/submerged/getting-started"  title="Geting started">Geting started</a>
              </li>
            
              
              <li>
                <a href="http://blog.repsaj.nl/index.php/series/azure-aquarium-monitor/" target="target" title="Blog">Blog</a>
              </li>
            

        </ul>

    </div>
</footer>

		
		<script src="/submerged/js/typer.js"></script>

		<script src="/submerged/js/geopattern.js"></script>

		<script src="/submerged/js/index.js"></script>

		 <script src="/submerged/js/popular_repo.js"></script> 

	</body>
</html>